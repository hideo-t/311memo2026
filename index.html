<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>3.11ãƒ¡ãƒ¢ãƒªãƒ¼ã‚¯ã‚¨ã‚¹ãƒˆï¼š#9ã¸é›†åˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: rgba(0,0,0,0);
        }

        :root {
            --color-yellow: #FFD700;
            --color-green: #7FFF00;
            --color-cyan: #00FFFF;
            --color-purple: #DA70D6;
            --bg-dark: #0a0a1a;
            --bg-game: #1a1a2e;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, var(--bg-dark), var(--bg-game));
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            color: white;
            overflow-x: hidden;
        }

        .game-container {
            max-width: 800px;
            width: 100%;
            background: var(--bg-game);
            border: 3px solid #444466;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
        }

        .stage {
            display: none;
        }

        .stage.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ */
        .title-screen {
            text-align: center;
            padding: 20px 10px;
        }

        .title-main {
            font-size: clamp(20px, 6vw, 32px);
            margin: 15px 0;
            background: linear-gradient(90deg, var(--color-yellow), var(--color-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.3;
        }

        .title-sub {
            font-size: clamp(16px, 5vw, 24px);
            margin: 15px 0;
            color: var(--color-cyan);
        }

        .start-button {
            padding: clamp(15px, 4vw, 20px) clamp(40px, 10vw, 60px);
            font-size: clamp(18px, 5vw, 24px);
            background: linear-gradient(135deg, var(--color-cyan), var(--color-purple));
            border: 3px solid white;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            margin: 20px 0;
            font-weight: bold;
            min-height: 50px;
            touch-action: manipulation;
        }

        .start-button:active {
            transform: scale(0.95);
        }

        /* ãƒŸãƒƒã‚·ãƒ§ãƒ³ç”»é¢ */
        .stage-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px 10px;
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #444466;
            border-radius: 8px;
        }

        .stage-header h2 {
            font-size: clamp(18px, 5vw, 24px);
            color: var(--color-cyan);
            margin-bottom: 8px;
            word-break: break-word;
        }

        .stage-header p {
            font-size: clamp(14px, 3.5vw, 16px);
            word-break: break-word;
        }

        .mission-item {
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #444466;
            border-radius: 8px;
        }

        .mission-item h3 {
            color: var(--color-yellow);
            margin-bottom: 12px;
            font-size: clamp(16px, 4vw, 18px);
        }

        .choice-btn {
            display: block;
            width: 100%;
            padding: clamp(12px, 3vw, 15px);
            margin: 8px 0;
            background: #2a2a4a;
            border: 2px solid #444466;
            color: white;
            font-size: clamp(14px, 3.5vw, 16px);
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            min-height: 48px;
            touch-action: manipulation;
            word-break: break-word;
        }

        .choice-btn:active {
            background: #3a3a6a;
        }

        .choice-btn.selected {
            background: linear-gradient(135deg, var(--color-green), #90EE90);
            border-color: var(--color-green);
            color: black;
            font-weight: bold;
        }

        .choice-btn.wrong {
            background: #ff4444;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .next-button {
            display: block;
            margin: 20px auto;
            padding: clamp(12px, 3vw, 15px) clamp(30px, 8vw, 40px);
            font-size: clamp(16px, 4vw, 18px);
            background: linear-gradient(135deg, var(--color-cyan), var(--color-purple));
            border: 2px solid var(--color-cyan);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            min-height: 48px;
            touch-action: manipulation;
        }

        .next-button:active {
            transform: scale(0.95);
        }

        /* ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚° */
        .ending-container {
            text-align: center;
            padding: 15px;
        }

        .ending-title {
            font-size: clamp(24px, 6vw, 32px);
            margin: 15px 0;
            color: var(--color-yellow);
            word-break: break-word;
        }

        .code-display {
            padding: 15px;
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid var(--color-cyan);
            border-radius: 8px;
            font-size: clamp(14px, 4vw, 20px);
            color: var(--color-cyan);
            margin: 15px 0;
            word-break: break-all;
        }

        .treasure-box {
            background: rgba(255, 215, 0, 0.1);
            border: 3px solid var(--color-yellow);
            border-radius: 12px;
            padding: 20px 15px;
            margin: 20px 0;
        }

        .treasure-box h3 {
            font-size: clamp(18px, 4.5vw, 22px);
        }

        .treasure-item {
            padding: 8px;
            margin: 6px 0;
            font-size: clamp(13px, 3.5vw, 16px);
            word-break: break-word;
        }

        .map-point {
            padding: clamp(15px, 4vw, 20px);
            background: #2a2a4a;
            border: 3px solid #444466;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
            min-width: 80px;
            touch-action: manipulation;
        }

        .map-point:active {
            transform: scale(0.95);
        }

        .map-point div:first-child {
            font-size: clamp(30px, 8vw, 40px);
        }

        .map-point div:last-child {
            font-size: clamp(12px, 3.5vw, 16px);
            font-weight: bold;
            margin-top: 5px;
        }

        /* Stage 2 Route Navigation */
        .route-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: clamp(10px, 3vw, 20px);
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .route-arrow {
            font-size: clamp(20px, 5vw, 30px);
            color: var(--color-cyan);
        }

        #venueInfo {
            padding: 20px 15px;
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid var(--color-cyan);
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }

        #venueInfo h3 {
            color: var(--color-cyan);
            margin-bottom: 12px;
            font-size: clamp(16px, 4vw, 20px);
            word-break: break-word;
        }

        #venueInfo p {
            margin: 8px 0;
            font-size: clamp(13px, 3.5vw, 16px);
            word-break: break-word;
        }

        /* Stage 3 Slot Game */
        #slotDisplay {
            min-height: clamp(100px, 25vw, 120px);
            background: linear-gradient(135deg, rgba(218, 112, 214, 0.2), rgba(218, 112, 214, 0.1));
            border: 4px solid var(--color-purple);
            border-radius: 16px;
            padding: clamp(20px, 5vw, 30px);
            font-size: clamp(20px, 5vw, 36px);
            font-weight: bold;
            color: var(--color-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.4;
            animation: pulse 2s ease-in-out infinite;
            word-break: break-word;
            hyphens: auto;
        }

        #spinButton {
            margin: 20px auto;
            padding: clamp(15px, 4vw, 20px) clamp(40px, 10vw, 60px);
            font-size: clamp(20px, 5vw, 28px);
            font-weight: bold;
            background: linear-gradient(135deg, var(--color-purple), #E587E5);
            border: 3px solid var(--color-purple);
            color: white;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            box-shadow: 0 0 20px rgba(218, 112, 214, 0.5);
            min-height: 56px;
            touch-action: manipulation;
        }

        #spinButton:active {
            transform: scale(0.95);
        }

        #judgmentButtons {
            display: none;
            margin: 20px 0;
            gap: clamp(10px, 3vw, 20px);
            justify-content: center;
            flex-wrap: wrap;
        }

        #judgmentButtons button {
            padding: clamp(15px, 4vw, 20px) clamp(30px, 8vw, 50px);
            font-size: clamp(18px, 4.5vw, 24px);
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin: 5px;
            min-height: 56px;
            flex: 1;
            min-width: 120px;
            max-width: 200px;
            touch-action: manipulation;
        }

        #judgmentButtons button:first-child {
            background: linear-gradient(135deg, var(--color-green), #90EE90);
            border: 3px solid var(--color-green);
            color: black;
        }

        #judgmentButtons button:last-child {
            background: linear-gradient(135deg, #ff4444, #ff6666);
            border: 3px solid #ff0000;
            color: white;
        }

        #judgmentButtons button:active {
            transform: scale(0.95);
        }

        #slotResult {
            display: none;
            margin: 20px auto;
            padding: 20px 15px;
            border-radius: 12px;
            font-size: clamp(16px, 4vw, 20px);
            max-width: 600px;
            line-height: 1.6;
            word-break: break-word;
        }

        .progress-display {
            text-align: center;
            font-size: clamp(16px, 4vw, 24px);
            padding: 15px;
            background: rgba(218, 112, 214, 0.1);
            border: 2px solid var(--color-purple);
            border-radius: 8px;
            color: var(--color-purple);
            font-weight: bold;
            margin: 15px 0;
        }

        .progress-display span {
            display: inline-block;
            margin: 5px 10px;
        }

        .badge {
            background: var(--color-cyan);
            color: black;
            padding: 6px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
            font-size: clamp(12px, 3vw, 14px);
        }

        .event-tags {
            margin: 15px 0;
        }

        .event-tags span {
            background: #ff1493;
            padding: 8px 15px;
            border-radius: 25px;
            margin: 5px;
            display: inline-block;
            font-size: clamp(12px, 3vw, 14px);
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(218, 112, 214, 0.5);
            }
            50% {
                box-shadow: 0 0 40px rgba(218, 112, 214, 0.8);
            }
        }

        /* å°ã•ã„ç”»é¢å‘ã‘ã®è¿½åŠ èª¿æ•´ */
        @media (max-width: 360px) {
            .game-container {
                padding: 10px;
            }
            
            .choice-btn, .next-button, .start-button, #spinButton, #judgmentButtons button {
                font-size: 14px;
            }
            
            .route-container {
                gap: 8px;
            }
            
            .map-point {
                padding: 12px;
                min-width: 70px;
            }
        }

        /* ãƒ©ãƒ³ãƒ‰ã‚¹ã‚±ãƒ¼ãƒ—ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ */
        @media (orientation: landscape) and (max-height: 500px) {
            body {
                padding: 5px;
            }
            
            .game-container {
                padding: 10px;
                max-height: 95vh;
                overflow-y: auto;
            }
            
            .stage-header {
                padding: 10px;
                margin-bottom: 15px;
            }
            
            .mission-item {
                margin: 15px 0;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Stage 0: ã‚¿ã‚¤ãƒˆãƒ« -->
        <div class="stage active" id="stage0">
            <div class="title-screen">
                <div class="badge">ç¬¬5å›</div>
                <h1 class="title-main">ç¦å³¶ã®å­ä¾›ãŸã¡ã®ãŸã‚ã«</h1>
                <h2 class="title-sub">3.11 ã€œã‚ã®æ—¥ã‚’å¿˜ã‚Œãªã„ã€œ</h2>
                <div class="event-tags">
                    <span>å…¥å ´ç„¡æ–™</span>
                    <span>å…¨å¸­è‡ªç”±</span>
                </div>
                <button class="start-button" onclick="startGame()">START QUEST</button>
            </div>
        </div>

        <!-- Stage 1: ãƒŸãƒƒã‚·ãƒ§ãƒ³ -->
        <div class="stage" id="stage1">
            <div class="stage-header">
                <h2>STAGE 1: MISSION BRIEFING</h2>
                <p style="color: var(--color-yellow);">ãƒŸãƒƒã‚·ãƒ§ãƒ³ï¼š#9ï¼ˆä¼šå ´ï¼‰ã«åˆ°é”ã›ã‚ˆ</p>
            </div>
            
            <div class="mission-item" id="mission1">
                <h3>â‘  æ—¥ä»˜ã‚’ç¢ºå®šã›ã‚ˆ</h3>
                <button class="choice-btn" onclick="selectChoice(1, 1, false)">3æœˆ7æ—¥ï¼ˆåœŸï¼‰</button>
                <button class="choice-btn" onclick="selectChoice(1, 2, true)">3æœˆ8æ—¥ï¼ˆæ—¥ï¼‰</button>
                <button class="choice-btn" onclick="selectChoice(1, 3, false)">3æœˆ9æ—¥ï¼ˆæœˆï¼‰</button>
            </div>

            <div class="mission-item" id="mission2" style="opacity: 0.3; pointer-events: none;">
                <h3>â‘¡ æ™‚é–“ã‚’ç¢ºå®šã›ã‚ˆ</h3>
                <button class="choice-btn" onclick="selectChoice(2, 1, false)">é–‹å ´11:00 / é–‹æ¼”11:30</button>
                <button class="choice-btn" onclick="selectChoice(2, 2, true)">é–‹å ´11:40 / é–‹æ¼”12:00</button>
                <button class="choice-btn" onclick="selectChoice(2, 3, false)">é–‹å ´12:00 / é–‹æ¼”12:30</button>
            </div>

            <div class="mission-item" id="mission3" style="opacity: 0.3; pointer-events: none;">
                <h3>â‘¢ "å¿˜ã‚Œãªã„è¨€è‘‰"ã‚’é¸ã¹</h3>
                <button class="choice-btn" onclick="selectChoice(3, 1, false)">å¿ƒã«åˆ»ã‚€æ—¥</button>
                <button class="choice-btn" onclick="selectChoice(3, 2, true)">ã‚ã®æ—¥ã‚’å¿˜ã‚Œãªã„</button>
                <button class="choice-btn" onclick="selectChoice(3, 3, false)">è¨˜æ†¶ã®ç¶™æ‰¿</button>
            </div>

            <button class="next-button" id="stage1Next" style="display: none;" onclick="nextStage(2)">NEXT STAGE â†’</button>
        </div>

        <!-- Stage 2: ãƒ«ãƒ¼ãƒˆé¸æŠ -->
        <div class="stage" id="stage2">
            <div class="stage-header">
                <h2>STAGE 2: ROUTE NAVIGATION</h2>
                <p style="color: var(--color-yellow);">ä¼šå ´ã¸ã®é“ã‚’ç¢ºå®šã›ã‚ˆ</p>
            </div>
            
            <div class="route-container">
                <div class="map-point" id="point1" onclick="selectPoint(1)" style="cursor: pointer;">
                    <div>ğŸ“</div>
                    <div>éƒ¡å±±é§…</div>
                </div>
                <div class="route-arrow">â†’</div>
                <div class="map-point" id="point2" onclick="selectPoint(2)" style="opacity: 0.3; cursor: pointer;">
                    <div>ğŸ™ï¸</div>
                    <div>å¤§ç”º</div>
                </div>
                <div class="route-arrow">â†’</div>
                <div class="map-point" id="point3" onclick="selectPoint(3)" style="opacity: 0.3; cursor: pointer;">
                    <div>ğŸª</div>
                    <div>#9</div>
                </div>
            </div>

            <div id="venueInfo" style="display: none;">
                <h3>EVENT SPACE Koriyama #9</h3>
                <p>ğŸ“ éƒ¡å±±å¸‚å¤§ç”º1-4-15</p>
                <p>ğŸ“ 024-973-5242</p>
                <p style="color: var(--color-yellow); margin-top: 10px;">éƒ¡å±±ãƒ“ãƒ«åœ°ä¸‹1éš</p>
            </div>

            <button class="next-button" id="stage2Next" style="display: none;" onclick="nextStage(3)">NEXT STAGE â†’</button>
        </div>

        <!-- Stage 3: å‡ºæ¼”è€…åå‰ã‚¹ãƒ­ãƒƒãƒˆ -->
        <div class="stage" id="stage3">
            <div class="stage-header">
                <h2>STAGE 3: NAME SLOT GAME</h2>
                <p style="color: var(--color-yellow);">ã“ã®åå‰ã€ã‚ã£ã¦ã‚‹ï¼Ÿï¼ˆ3å›ãƒ—ãƒ¬ã‚¤ã§ã‚¯ãƒªã‚¢ï¼‰</p>
            </div>
            
            <!-- ã‚¹ãƒ­ãƒƒãƒˆè¡¨ç¤ºæ  -->
            <div style="text-align: center; margin: 30px 0;">
                <div id="slotDisplay">
                    SPINãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„
                </div>

                <!-- SPINãƒœã‚¿ãƒ³ -->
                <button id="spinButton" onclick="spinSlot()">
                    ğŸ° SPIN
                </button>

                <!-- åˆ¤å®šãƒœã‚¿ãƒ³ -->
                <div id="judgmentButtons">
                    <button onclick="judgeAnswer(true)">
                        â—‹ YES
                    </button>
                    <button onclick="judgeAnswer(false)">
                        Ã— NO
                    </button>
                </div>

                <!-- çµæœè¡¨ç¤º -->
                <div id="slotResult"></div>
            </div>

            <!-- é€²è¡ŒçŠ¶æ³ -->
            <div class="progress-display">
                <span>ãƒ—ãƒ¬ã‚¤: <span id="spinCount">0</span>/3</span>
                <span>æ­£è§£: <span id="correctCount">0</span></span>
            </div>

            <button class="next-button" id="stage3Next" style="display: none;" onclick="nextStage(4)">NEXT STAGE â†’</button>
        </div>

        <!-- Stage 4: è¨˜æ†¶ãƒ†ã‚¹ãƒˆ -->
        <div class="stage" id="stage4">
            <div class="stage-header">
                <h2>STAGE 4: MEMORY TEST</h2>
                <p style="color: var(--color-yellow);">è¨˜æ†¶ã‚’ç¢ºèªã›ã‚ˆ</p>
            </div>
            
            <div class="mission-item" id="quiz1">
                <h3>Q1: ã‚¤ãƒ™ãƒ³ãƒˆã®æ—¥ä»˜ã¯ï¼Ÿ</h3>
                <button class="choice-btn" onclick="answerQuiz(1, 1, false)">3æœˆ7æ—¥</button>
                <button class="choice-btn" onclick="answerQuiz(1, 2, true)">3æœˆ8æ—¥</button>
                <button class="choice-btn" onclick="answerQuiz(1, 3, false)">3æœˆ9æ—¥</button>
            </div>

            <div class="mission-item" id="quiz2" style="display: none;">
                <h3>Q2: é–‹æ¼”æ™‚åˆ»ã¯ï¼Ÿ</h3>
                <button class="choice-btn" onclick="answerQuiz(2, 1, false)">11:40</button>
                <button class="choice-btn" onclick="answerQuiz(2, 2, true)">12:00</button>
                <button class="choice-btn" onclick="answerQuiz(2, 3, false)">12:30</button>
            </div>

            <div class="mission-item" id="quiz3" style="display: none;">
                <h3>Q3: ä¼šå ´åã¯ï¼Ÿ</h3>
                <button class="choice-btn" onclick="answerQuiz(3, 1, false)">éƒ¡å±±å¸‚æ°‘æ–‡åŒ–ã‚»ãƒ³ã‚¿ãƒ¼</button>
                <button class="choice-btn" onclick="answerQuiz(3, 2, true)">Koriyama #9</button>
                <button class="choice-btn" onclick="answerQuiz(3, 3, false)">éƒ¡å±±å¸‚æ°‘ä¼šé¤¨</button>
            </div>

            <div id="quizResult" style="display: none; padding: 20px; text-align: center; font-size: clamp(18px, 5vw, 24px); border-radius: 8px; font-weight: bold; margin: 20px 0;"></div>

            <button class="next-button" id="stage4Next" style="display: none;" onclick="nextStage(5)">FINAL STAGE â†’</button>
        </div>

        <!-- Stage 5: ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚° -->
        <div class="stage" id="stage5">
            <div class="ending-container">
                <h2 class="ending-title">ğŸ‰ QUEST CLEAR! ğŸ‰</h2>
                <p style="margin: 15px 0;">è¨˜æ†¶ãŒèµ·å‹•ã—ã¾ã—ãŸã€‚</p>
                <p style="color: #aaa;">ã‚ãªãŸã®åˆè¨€è‘‰</p>
                <div class="code-display">FUKUSHIMA-311-KORIYAMA#9</div>
                
                <div class="treasure-box">
                    <h3 style="color: var(--color-yellow); margin-bottom: 12px;">ğŸ ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±</h3>
                    <div class="treasure-item">ğŸ“… 3æœˆ8æ—¥ï¼ˆæ—¥ï¼‰</div>
                    <div class="treasure-item">ğŸ• é–‹å ´11:40 / é–‹æ¼”12:00</div>
                    <div class="treasure-item">ğŸ“ EVENT SPACE Koriyama #9</div>
                    <div class="treasure-item">ğŸ¢ éƒ¡å±±å¸‚å¤§ç”º1-4-15 éƒ¡å±±ãƒ“ãƒ«åœ°ä¸‹1éš</div>
                    <div class="treasure-item">âœ… å…¥å ´ç„¡æ–™ï¼ˆå…¨å¸­è‡ªç”±ï¼‰</div>
                    <div class="treasure-item">ğŸ æ¥å ´ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆå…ˆç€150åï¼ˆé«˜æ ¡ç”Ÿä»¥ä¸‹ï¼‰</div>
                </div>

                <button class="next-button" onclick="location.reload()">ğŸ”„ ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
            </div>
        </div>
    </div>

    <script>
        console.log('ğŸ® 3.11ãƒ¡ãƒ¢ãƒªãƒ¼ã‚¯ã‚¨ã‚¹ãƒˆèµ·å‹•');

        function startGame() {
            console.log('ã‚²ãƒ¼ãƒ é–‹å§‹');
            nextStage(1);
        }

        function nextStage(stageNum) {
            console.log('Stage', stageNum, 'ã¸é·ç§»');
            document.querySelectorAll('.stage').forEach(s => s.classList.remove('active'));
            const stage = document.getElementById('stage' + stageNum);
            if (stage) {
                stage.classList.add('active');
                console.log('Stage', stageNum, 'è¡¨ç¤ºæˆåŠŸ');
            }
            window.scrollTo(0, 0);
        }

        let completedMissions = 0;
        let routeProgress = 0;
        let quizCorrect = 0;

        // Stage 3: ã‚¹ãƒ­ãƒƒãƒˆã‚²ãƒ¼ãƒ ç”¨
        let spinCount = 0;
        let correctAnswers = 0;
        let currentCorrectName = '';
        let currentDisplayName = '';
        let isCorrectDisplay = false;

        const artists = [
            'ãƒ†ãƒ«G',
            'é«˜æ©‹è¿·äºº',
            'åŠ è—¤æ¼¢å¤ª',
            'å²¡ç”°ç´”å­',
            'æ©‹æœ¬å¦™å­',
            'æ¸…æ°´å…¼ä¸€',
            'ä¼Šè—¤å’Œå“‰',
            'ãƒãƒ’ãƒ­ã‚¹ã‚¿ãƒ¼ã‚ºãƒ•ãƒ©ãƒãƒ¼ãƒ ',
            'å¤§æ§»ã„ãã‚’',
            'åŸç”°é›ªè¦‹',
            'KUSANO',
            'ã‚¢ãƒ™ãƒãƒ³ã‚»ã‚¤',
            'ç›¸è‰¯è£•æˆ',
            '"~ing',
            'Lumiere',
            'mone',
            'å¤§ç£',
            'èŠ¦åŸä¼šé¤¨',
            'ç¦å³¶ã‚¹ãƒãƒ¼ãƒ„ã‚¢ã‚«ãƒ‡ãƒŸãƒ¼',
            'STUDIO DANCE HEAD',
            'ç©ºå…ˆæ‹“æµ·'
        ];

        // å½åç”Ÿæˆãƒ‘ã‚¿ãƒ¼ãƒ³
        const fakeNamePatterns = [
            (name) => name.length > 1 ? name.substring(0, name.length - 1) + getRandomChar() : name + 'ãƒ¼',
            (name) => {
                const pos = Math.floor(name.length / 2);
                return name.substring(0, pos) + ' ' + name.substring(pos);
            },
            (name) => name + 'ãƒ¼',
            (name) => {
                const pos = Math.floor(name.length / 2);
                return name.substring(0, pos) + 'ãƒ»' + name.substring(pos);
            },
            (name) => name + name.charAt(name.length - 1),
            (name) => {
                const kanaMap = {'é«˜':'ãŸã‹', 'æ©‹':'ã¯ã—', 'ç”°':'ãŸ', 'åŸ':'ã¯ã‚‰', 'è—¤':'ã¨ã†', 'å·':'ã‹ã‚'};
                for (let [k, v] of Object.entries(kanaMap)) {
                    if (name.includes(k)) {
                        return name.replace(k, v);
                    }
                }
                return name + 'ï¼Ÿ';
            },
            (name) => name.replace(/["\~ãƒ»]/g, ''),
            (name) => {
                const typos = {
                    'è¿·':'è¬', 'æ¼¢':'æ„Ÿ', 'ç´”':'é †', 'å¦™':'ç§’', 'å…¼':'åˆ¸',
                    'å“‰':'ä¹Ÿ', 'é›ª':'é›¨', 'è£•':'ç¥', 'æ‹“':'å“', 'å…ˆ':'å…‰'
                };
                for (let [k, v] of Object.entries(typos)) {
                    if (name.includes(k)) {
                        return name.replace(k, v);
                    }
                }
                return name + 'ã•ã‚“';
            }
        ];

        function getRandomChar() {
            const chars = 'ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ãªã«ã¬ã­ã®';
            return chars[Math.floor(Math.random() * chars.length)];
        }

        function generateFakeName(correctName) {
            const pattern = fakeNamePatterns[Math.floor(Math.random() * fakeNamePatterns.length)];
            let fakeName = pattern(correctName);
            if (fakeName === correctName) {
                fakeName = correctName + 'ï¼Ÿ';
            }
            return fakeName;
        }

        function getCommentary(correctName, wasCorrect) {
            const commentaries = {
                'é«˜æ©‹è¿·äºº': ['â€»è¿·äººã¯è¿·äººã§ã™ï¼ˆè¿·ã£ã¦ã¾ã›ã‚“ï¼‰', 'â€»æœ¬åã§ã™ã€è¿·å­ã˜ã‚ƒãªã„ã§ã™'],
                'åŠ è—¤æ¼¢å¤ª': ['â€»æ¼¢å­—ãŒã‚´ãƒ„ã„ã§ã™ãŒå„ªã—ã„æ–¹ã§ã™', 'â€»æ¼¢å¤ªã§"ã‹ã‚“ãŸ"ã§ã™'],
                '"~ing': ['â€»è¨˜å·ã¾ã§å«ã‚ã¦æ­£å¼åã§ã™', 'â€»å…¥åŠ›æ³£ã‹ã›æ ', 'â€»ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚æœ¬åã§ã™'],
                'ãƒ†ãƒ«G': ['â€»Gã¯ã‚¸ãƒ¼ã§ã™', 'â€»ãƒ†ãƒ«çˆºã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“'],
                'KUSANO': ['â€»å…¨éƒ¨å¤§æ–‡å­—ãŒæ­£è§£ã§ã™', 'â€»kusanoã¯æƒœã—ã„'],
                'ãƒãƒ’ãƒ­ã‚¹ã‚¿ãƒ¼ã‚ºãƒ•ãƒ©ãƒãƒ¼ãƒ ': ['â€»é•·ã„ã‘ã©å…¨éƒ¨æ­£å¼åã§ã™', 'â€»çœç•¥ä¸å¯ã§ã™'],
                'ç¦å³¶ã‚¹ãƒãƒ¼ãƒ„ã‚¢ã‚«ãƒ‡ãƒŸãƒ¼': ['â€»FSAãƒ€ãƒ³ã‚¹ã‚¹ã‚¯ãƒ¼ãƒ«ã®æ­£å¼åç§°ã§ã™'],
                'STUDIO DANCE HEAD': ['â€»STUDIOã‚‚å«ã¿ã¾ã™', 'â€»å…¨éƒ¨å¤§æ–‡å­—ã§ã™'],
                'ç©ºå…ˆæ‹“æµ·': ['â€»ã€Œãã‚‰ã•ãã€ã§ã™', 'â€»ç©ºãŒè‹—å­—ã€æ‹“æµ·ãŒåå‰']
            };

            if (wasCorrect) {
                return 'æ­£è§£ï¼ å®Œç’§ã§ã™ï¼';
            } else {
                const specific = commentaries[correctName];
                if (specific) {
                    return specific[Math.floor(Math.random() * specific.length)];
                }
                return 'â€»æ­£å¼åã¯ã“ã¡ã‚‰ã§ã™';
            }
        }

        function spinSlot() {
            document.getElementById('spinButton').disabled = true;
            document.getElementById('spinButton').style.opacity = '0.5';
            
            currentCorrectName = artists[Math.floor(Math.random() * artists.length)];
            isCorrectDisplay = Math.random() < 0.5;
            
            if (isCorrectDisplay) {
                currentDisplayName = currentCorrectName;
            } else {
                currentDisplayName = generateFakeName(currentCorrectName);
            }
            
            const display = document.getElementById('slotDisplay');
            let spinTimes = 0;
            const spinInterval = setInterval(() => {
                display.textContent = artists[Math.floor(Math.random() * artists.length)];
                spinTimes++;
                
                if (spinTimes >= 10) {
                    clearInterval(spinInterval);
                    display.textContent = currentDisplayName;
                    display.style.animation = 'none';
                    
                    document.getElementById('judgmentButtons').style.display = 'flex';
                    document.getElementById('slotResult').style.display = 'none';
                }
            }, 100);
        }

        function judgeAnswer(userSaysYes) {
            const isCorrect = (userSaysYes === isCorrectDisplay);
            
            spinCount++;
            if (isCorrect) {
                correctAnswers++;
            }
            
            document.getElementById('spinCount').textContent = spinCount;
            document.getElementById('correctCount').textContent = correctAnswers;
            
            const resultDiv = document.getElementById('slotResult');
            resultDiv.style.display = 'block';
            
            if (isCorrect) {
                resultDiv.style.background = 'linear-gradient(135deg, var(--color-green), #90EE90)';
                resultDiv.style.color = 'black';
                resultDiv.style.border = '3px solid var(--color-green)';
                resultDiv.innerHTML = `
                    <div style="font-size: clamp(24px, 6vw, 32px); margin-bottom: 10px;">âœ… æ­£è§£ï¼</div>
                    <div style="font-size: clamp(14px, 3.5vw, 18px);">${getCommentary(currentCorrectName, true)}</div>
                    <div style="margin-top: 10px; font-size: clamp(14px, 3.5vw, 16px); color: #333;">+HOPE</div>
                `;
            } else {
                resultDiv.style.background = 'linear-gradient(135deg, #ff6666, #ff8888)';
                resultDiv.style.color = 'white';
                resultDiv.style.border = '3px solid #ff0000';
                resultDiv.innerHTML = `
                    <div style="font-size: clamp(24px, 6vw, 32px); margin-bottom: 10px;">âŒ æƒœã—ã„ï¼</div>
                    <div style="font-size: clamp(16px, 4vw, 20px); margin: 12px 0;">
                        è¡¨ç¤º: <span style="text-decoration: line-through;">${currentDisplayName}</span>
                    </div>
                    <div style="font-size: clamp(18px, 4.5vw, 24px); margin: 12px 0; font-weight: bold;">
                        æ­£è§£: ${currentCorrectName}
                    </div>
                    <div style="font-size: clamp(14px, 3.5vw, 16px); margin-top: 10px; opacity: 0.9;">
                        ${getCommentary(currentCorrectName, false)}
                    </div>
                `;
            }
            
            document.getElementById('judgmentButtons').style.display = 'none';
            
            if (spinCount >= 3) {
                setTimeout(() => {
                    showFinalResult();
                }, 2000);
            } else {
                setTimeout(() => {
                    document.getElementById('spinButton').disabled = false;
                    document.getElementById('spinButton').style.opacity = '1';
                    document.getElementById('slotDisplay').textContent = 'ã‚‚ã†ä¸€åº¦SPINã—ã¦ãã ã•ã„';
                    document.getElementById('slotDisplay').style.animation = 'pulse 2s ease-in-out infinite';
                }, 2000);
            }
        }

        function showFinalResult() {
            const resultDiv = document.getElementById('slotResult');
            let title = '';
            let message = '';
            
            if (correctAnswers === 3) {
                title = 'ğŸ† æ­£å¼åãƒã‚¹ã‚¿ãƒ¼';
                message = 'å®Œç’§ã§ã™ï¼å‡ºæ¼”è€…ã‚’å®Œå…¨æŠŠæ¡ï¼';
                resultDiv.style.background = 'linear-gradient(135deg, #FFD700, #FFA500)';
                resultDiv.style.color = 'black';
            } else if (correctAnswers === 2) {
                title = 'â­ ã‹ãªã‚Šè©³ã—ã„';
                message = 'ç´ æ™´ã‚‰ã—ã„ï¼ã‚‚ã†ä¸€æ¯ã§å®Œç’§ï¼';
                resultDiv.style.background = 'linear-gradient(135deg, #C0C0C0, #E0E0E0)';
                resultDiv.style.color = 'black';
            } else if (correctAnswers === 1) {
                title = 'ğŸŒŸ ã“ã‚Œã‹ã‚‰æ¨ã›ã‚‹';
                message = 'è‰¯ã„ã‚¹ã‚¿ãƒ¼ãƒˆï¼ã“ã‚Œã‹ã‚‰è¦šãˆã‚ˆã†ï¼';
                resultDiv.style.background = 'linear-gradient(135deg, #CD7F32, #D4A574)';
                resultDiv.style.color = 'white';
            } else {
                title = 'ğŸ˜… é€†ã«æ‰èƒ½ï¼ˆå¿˜å´ç‹ï¼‰';
                message = 'ã¾ã‚ã€åå‰ã¯é›£ã—ã„ã§ã™ã‚ˆã­â€¦';
                resultDiv.style.background = 'linear-gradient(135deg, #9370DB, #BA55D3)';
                resultDiv.style.color = 'white';
            }
            
            resultDiv.innerHTML = `
                <div style="font-size: clamp(24px, 6vw, 36px); margin-bottom: 12px;">${title}</div>
                <div style="font-size: clamp(16px, 4vw, 20px); margin-bottom: 10px;">${message}</div>
                <div style="font-size: clamp(18px, 5vw, 24px); font-weight: bold;">
                    çµæœ: ${correctAnswers} / 3 æ­£è§£
                </div>
            `;
            
            document.getElementById('spinButton').style.display = 'none';
            
            setTimeout(() => {
                document.getElementById('stage3Next').style.display = 'block';
            }, 1500);
        }

        function selectChoice(missionNum, choiceNum, isCorrect) {
            console.log('é¸æŠ:', missionNum, choiceNum, isCorrect);
            
            const mission = document.getElementById('mission' + missionNum);
            const buttons = mission.querySelectorAll('.choice-btn');
            const clickedButton = buttons[choiceNum - 1];

            if (isCorrect) {
                clickedButton.classList.add('selected');
                buttons.forEach(btn => btn.disabled = true);
                completedMissions++;

                setTimeout(() => {
                    if (missionNum < 3) {
                        const nextMission = document.getElementById('mission' + (missionNum + 1));
                        nextMission.style.opacity = '1';
                        nextMission.style.pointerEvents = 'auto';
                    } else {
                        document.getElementById('stage1Next').style.display = 'block';
                    }
                }, 500);
            } else {
                clickedButton.classList.add('wrong');
                setTimeout(() => clickedButton.classList.remove('wrong'), 500);
            }
        }

        function selectPoint(pointNum) {
            if (pointNum !== routeProgress + 1) return;
            
            const point = document.getElementById('point' + pointNum);
            point.style.opacity = '1';
            point.style.background = 'linear-gradient(135deg, var(--color-green), #90EE90)';
            point.style.color = 'black';
            
            routeProgress = pointNum;
            console.log('ãƒã‚¤ãƒ³ãƒˆ', pointNum, 'åˆ°é”');
            
            if (pointNum < 3) {
                setTimeout(() => {
                    document.getElementById('point' + (pointNum + 1)).style.opacity = '1';
                }, 300);
            } else {
                setTimeout(() => {
                    document.getElementById('venueInfo').style.display = 'block';
                    document.getElementById('stage2Next').style.display = 'block';
                }, 500);
            }
        }

        function answerQuiz(quizNum, answerNum, isCorrect) {
            console.log('ã‚¯ã‚¤ã‚º', quizNum, 'å›ç­”:', answerNum, isCorrect);
            
            const quiz = document.getElementById('quiz' + quizNum);
            const buttons = quiz.querySelectorAll('.choice-btn');
            const clickedButton = buttons[answerNum - 1];

            if (isCorrect) {
                clickedButton.classList.add('selected');
                buttons.forEach(btn => btn.disabled = true);
                quizCorrect++;

                setTimeout(() => {
                    quiz.style.display = 'none';
                    
                    if (quizNum < 3) {
                        document.getElementById('quiz' + (quizNum + 1)).style.display = 'block';
                    } else {
                        const result = document.getElementById('quizResult');
                        result.style.display = 'block';
                        
                        if (quizCorrect === 3) {
                            result.textContent = 'ğŸ‰ PERFECT! è¨˜æ†¶å®Œç’§ï¼';
                            result.style.background = 'linear-gradient(135deg, var(--color-green), #90EE90)';
                            result.style.color = 'black';
                        } else {
                            result.textContent = `æ­£è§£: ${quizCorrect} / 3`;
                            result.style.background = 'rgba(255, 215, 0, 0.2)';
                            result.style.color = 'var(--color-yellow)';
                        }
                        
                        setTimeout(() => {
                            document.getElementById('stage4Next').style.display = 'block';
                        }, 1000);
                    }
                }, 500);
            } else {
                clickedButton.classList.add('wrong');
                setTimeout(() => clickedButton.classList.remove('wrong'), 500);
            }
        }

        console.log('æº–å‚™å®Œäº†ï¼');
    </script>
</body>
</html>